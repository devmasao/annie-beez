{{!< default}}
{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

{{!-- Everything inside the #post tags pulls data from the post --}}
{{#post}}
    <header class="site-header outer {{#if feature_image}}" style="background-image: url({{feature_image}}){{else}}no-cover{{/if}}">
        <div class="inner">
            {{> "site-nav"}}
            <div class="site-header-content">
                <h1 class="site-title">{{title}}</h1>
                <h2 class="site-description">
                    {{#if description}}
                        {{description}}
                    {{/if}}
                </h2>
            </div>
        </div>
    </header>

    {{!-- The main content area --}}
    <main id="site-main" class="site-main outer" role="main">
        <div class="inner">
            <div class="post-feed">
                {{#foreach posts}}
                    {{!-- The tag below includes the markup for each post - partials/post-card.hbs --}}
                    {{> "post-card"}}
                {{/foreach}}
            </div>
        </div>
    </main>

{{/post}}

{{!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs --}}
{{#contentFor "scripts"}}
    <script>
        $(function() {
            var $postContent = $(".post-full-content");
            $postContent.fitVids();
        });
    </script>

    <script>
        $(document).ready(function () {
            $.ajax({
                url: ghost.url.api('tags'),
                type: 'get'
            }).done(function(data) {
                $.each(data.tags, function(i, tag) {
                    if((tag.slug).endsWith('-series')) {
                        var html = getSeriesCard(tag);
                        console.log(html);
                        $('.post-feed').append(html);
                    }
                });
            });
        });

        function getSeriesCard(tag) {
            console.log(tag);
            return '<article class="post-card post tag-series"> \
                        <a class="post-card-image-link" href="/' + tag.slug + '"> \
                            <div class="post-card-image" style="background-image: url(' + tag.feature_image + ')"></div> \
                        </a> \
                        <div class="post-card-content"> \
                            <a class="post-card-content-link" href="/' + tag.slug + '"> \
                                <header class="post-card-header"> \
                                    <h2 class="post-card-title">' + tag.name + '</h2> \
                                </header> \
                            </a> \
                        </div> \
                    </article>'
        }
    </script>
{{/contentFor}}
